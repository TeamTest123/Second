<!DOCTYPE HTML>
<html>
<head>
<title>single</title>
<script src="js/vue.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/axios/0.19.2/axios.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords"
	content="Nuevo Responsive web template, Bootstrap Web Templates, Flat Web Templates, Andriod Compatible web template, 
Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyErricsson, Motorola web design" />
<script type="applijegleryion/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
<link href="css/bootstrap.css" rel='stylesheet' type='text/css' />
<!-- Custom Theme files -->
<link href="css/style.css" rel='stylesheet' type='text/css' />
<script src="js/jquery-1.11.1.min.js"></script>
<!-- start menu -->
<link href="css/megamenu.css" rel="stylesheet" type="text/css"
	media="all" />
<script type="text/javascript" src="js/megamenu.js"></script>
<script>$(document).ready(function(){$(".megamenu").megamenu();});</script>
<script src="js/menu_jquery.js"></script>
<script src="js/simpleCart.min.js"> </script>
<script src="js/bootstrap.js"> </script>
<!--web-fonts-->
<link
	href='http://fonts.useso.com/css?family=Open+Sans:400,300,400italic,300italic,600,700'
	rel='stylesheet' type='text/css'>
<link href='http://fonts.useso.com/css?family=Roboto+Slab:300,400,700'
	rel='stylesheet' type='text/css'>
<!--//web-fonts-->
<script src="js/modernizr.custom.js"></script>
<script type="text/javascript" src="js/move-top.js"></script>
<script type="text/javascript" src="js/easing.js"></script>
<link rel="stylesheet" href="css/flexslider.css" type="text/css"
	media="screen" />

<!--/script-->
<script type="text/javascript">
			jQuery(document).ready(function($) {
				$(".scroll").click(function(event){		
					event.preventDefault();
					$('html,body').animate({scrollTop:$(this.hash).offset().top},900);
				});
			});
</script>
<!-- the jScrollPane script -->
<script type="text/javascript" src="js/jquery.jscrollpane.min.js"></script>
<script type="text/javascript" id="sourcecode">
			$(function()
			{
				$('.scroll-pane').jScrollPane();
			});
		</script>
<!-- //the jScrollPane script -->
</head>
<body>
	<!--start-home-->
	<!-- header_top -->
	<div class="top_bg" id="home">
		<div class="container">
			<div class="header_top">
				<div class="top_right">
					<ul>
						<li><a href="#">help</a></li>
						<li><a href="contact.html">Contact</a></li>
						<li><a href="#">Delivery information</a></li>
					</ul>
				</div>
				<div class="top_left">
					<h6>
						<span></span> 联系电话: 032 2352 782
					</h6>
				</div>
				<div class="clearfix"></div>
			</div>
		</div>
	</div>
	<!-- header -->
<div class="header_bg">
   <div class="container">
	<div class="header">
	  <div class="head-t">
		 <div class="logo">
			  <a href="index.html"><h1>购物 <span>商城</span></h1> </a>
		  </div>
		  <div class="header_right">
			<div class="cart box_1" id='app3'>
				<a href="checkout.html">
				<div class="total" >
					<span >
					</span> 我的购物车</div>
					<i class="glyphicon glyphicon-购物-cart"></i></a>
					<div class="login_info fl" v-if="onlogin">
						欢迎：<em>{{uname}}</em>
					</div>
					<div class="login_btn fl">
						<a href="account.html" v-if="outlogin">登录</a>
						<span> | </span>
						<a href="account.html" v-if="onlogin">退出</a>
						<span> | </span>
					 </div>	
				<p><a href="javascript:;" class="simpleCart_empty"></a></p>
				<div class="clearfix" > </div>
			</div>		
				 
		</div>
		<div class="clearfix"></div>	
	    </div>
	    
	    <script type="text/javascript">
	     	var user=new Vue({
	    		el : '#app3',
	    		data : {
	    			onlogin:false,
	    			outlogin:true,
	    			uname : ''
	    			
	    		},
	    		mounted:function(){
	    			console.info('----------');
	    			//并发访问
	    			axios.all([check()]).then(
	    				axios.spread((fn1)=>{
	    				//用户是否登录判断   返回的结果中存储用户信息	user
	    				if(fn1.data){
	    					this.onlogin=true;
	    					this.outlogin=false;
	    					this.uname=fn1.data.uname;
	    					console.info(this.uname);
	    				}else{
	    					//未登录
	    					this.onlogin=false;
	    					this.outlogin=true;
	    				}
	    				})
	    			
	    			)
	    			},
	    	});
	    
	    	//检查用户是否登录
	    	function check(){
	    		return axios.get("loginUser.s?op=doPost");
	    	} 
	    </script>
		<!--start-header-menu-->
		
		<!-- 商品展示- -->
	<ul  class="megamenu skyblue" id='app1' >
		
			<li class="active grid">
			<a class="color1" href="index.html">首页</a></li>
			<li class="grid" 
			 v-for="c in list">
				<a class="color9" :href="'product.html#'+c.bname">{{c.bname}}</a>
				</li><li ><a href="product.html"></a></li>
			</ul>  
	</div>
</div>
</div>

<script type="text/javascript">
  		 var v=new Vue({
  			el:"#app1",
  			data:{
  				list:[],
  			},
  			created(){
  				axios.get("fen.s").then(res=>{
  					//res axios 封装的响应结果对象
  					this.list=res.data;
  					console.log(res.data);
  				});
  			}
  		}) 
  		 </script>
	<!--start-content-->
	<!-- products -->
	<div class="products" id="intro">
		<div class="container">
			<div class="products-grids">
				<div class="col-md-8 products-single">
					<div class="col-md-5 grid-single">
						<div class="flexslider">
							<ul class="slides">
									<div>
										<img :src="product.image" data-imagezoom="true"
											class="img-responsive" alt="" />
									</div>

							</ul>
						</div>
						

					</div>
					<div class="col-md-7 single-text">
						<div class="details-left-info simpleCart_shelfItem">
							<h3>商品名称</h3>
							<p class="availability">
								{{product.pname}}<span class="color"></span>
							</p>
							<div class="price_single">
								<h3>商品价格</h3>
								<span class="actual item_price">{{product.price}}</span><a
									href="#"></a>
							</div>
							<h3>颜色</h3>
							<ul class="product-colors">
								<li><a  href="#"><span>{{product.color}}
									</span></a></li>

							</ul>

							<div class="quantity_box">
								<span>库存</span>
								<div class="product-qty">
									<span>{{product.number}}</span>
								</div>
							</div>
							<div class="clearfix"></div>
							<div class="single-but item_add">
								<input @click="add" type="submit" value="加入购物车" />
							</div>
						</div>
					</div>
					<div class="clearfix"></div>
				</div>

				<div class="clearfix"></div>
				<!-- collapse -->
				<div class="panel-group collpse" id="accordion" role="tablist"
					aria-multiselectable="true">
					<div class="panel panel-default">
						<div class="panel-heading" role="tab" id="headingOne">
							<h4 class="panel-title">
								<a role="button" data-toggle="collapse" data-parent="#accordion"
									href="#collapseOne" aria-expanded="true"
									aria-controls="collapseOne"> 商品详情 </a>
							</h4>
						</div>
						<div id="collapseOne" class="panel-collapse collapse in"
							role="tabpanel" aria-labelledby="headingOne">
							<div class="panel-body">{{product.content}}</div>
						</div>
					</div>



					<!-- collapse -->
					<!--/start-latest-->

					<!--//latest-->
				</div>
			</div>
		</div>
	</div>
<!-- FlexSlider -->
	<script src="js/imagezoom.js"></script>
	<script defer src="js/jquery.flexslider.js"></script>
	<script>
	// Can also be used with $(document).ready()
	$(window).load(function() {
	  $('.flexslider').flexslider({
		animation: "slide",
		controlNav: "thumbnails"
	  });
	});
	</script>
	<script type="text/javascript">
	var v=new Vue({
		el:"#intro",
		data:{
			product:'',
			list:'',
			num:0,
			cnt:0,
		},
		created(){
			axios.get("singer.s?id="+location.hash.substring(1)).then(res=>{
				console.log(res.data);
				this.product=res.data;
			});
			axios.get("cart.s?op=getcnt&pid="+location.hash.substring(1)).then(res=>{
				this.cnt=res.data;
			
			});
		},
		methods:{
			add(){
				//判断商品用户购物车商品数是否大于0
				if(this.cnt>=1){
					axios.get("cart.s?op=updatecart&pid="+location.hash.substring(1)).then(res=>{
						alert(res.data);
						location.href="checkout.html";
					});
					//添加购物车成功后商品数减一
					 axios.get("num.s?op=updatenum&pid="+location.hash.substring(1)).then(res=>{
						
					}); 
				}else{
					var p=new URLSearchParams();
					p.append("pid",this.product.pid);
					p.append("number",1);
					axios.post("add.s",p
					).then(res=>{
	  					//res axios 封装的响应结果对象
	  					this.list=res.data;
	  					console.log(res.data);
	  					alert(res.data);
	  					location.href="checkout.html";
	  				});
					axios.get("num.s?op=updatenum&pid="+location.hash.substring(1)).then(res=>{
						
					}); 
				}
				
			}
		}
	})
	</script>
	<!-- //products -->
	<!--start-bottom-->
	<!--start-image-cursuals-->
	<div class="scroll-slider">
		<div class="container">
			<div class="nbs-flexisel-container">
				<div class="nbs-flexisel-inner">
					<ul class="flexiselDemo3 nbs-flexisel-ul"
						style="left: -253.6px; display: block;">
						<li onclick="location.href='#';" class="nbs-flexisel-item"
							style="width: 253.6px;"><img src="images/c3.png" alt="" /></li>
						<li onclick="location.href='#';" class="nbs-flexisel-item"
							style="width: 253.6px;"><img src="images/c4.png" alt="" /></li>
						<li onclick="location.href='#';" class="nbs-flexisel-item"
							style="width: 253.6px;"><img src="images/c1.png" alt="" /></li>
						<li onclick="location.href='#';" class="nbs-flexisel-item"
							style="width: 253.6px;"><img src="images/c2.png" alt="" /></li>
						<li onclick="location.href='#';" class="nbs-flexisel-item"
							style="width: 253.6px;"><img src="images/c3.png" alt="" /></li>
						<li onclick="location.href='#';" class="nbs-flexisel-item"
							style="width: 253.6px;"><img src="images/c4.png" alt="" /></li>
						<li onclick="location.href='#';" class="nbs-flexisel-item"
							style="width: 253.6px;"><img src="images/c1.png" alt="" /></li>
						<li onclick="location.href='#';" class="nbs-flexisel-item"
							style="width: 253.6px;"><img src="images/c2.png" alt="" /></li>
					</ul>
					<div class="nbs-flexisel-nav-left" style="top: 21.5px;"></div>
					<div class="nbs-flexisel-nav-right" style="top: 21.5px;"></div>
				</div>
			</div>
			<div class="clearfix"></div>
			<!--start-image-->
			<script type="text/javascript" src="js/jquery.flexisel.js"></script>
			<!--//end-->
			<script type="text/javascript">
								$(window).load(function() {
								    $(".flexiselDemo3").flexisel({
								        visibleItems: 5,
								        animationSpeed: 1000,
								        autoPlay: true,
								        autoPlaySpeed: 3000,            
								        pauseOnHover: true,
								        enableResponsiveBreakpoints: true,
								        responsiveBreakpoints: { 
								            portrait: { 
								                changePoint:480,
								                visibleItems: 2
								            }, 
								            landscape: { 
								                changePoint:640,
								                visibleItems: 3
								            },
								            tablet: { 
								                changePoint:768,
								                visibleItems: 3
								            }
								        }
								    });
								});
								</script>
			<!---->
		</div>
	</div>
	<!--//end-bottom-->
	<!--start-footer-->
	
	<ul class="socials">
		<li><a class="soc1" href="#"></a></li>
		<li><a class="soc2" href="#"></a></li>
		<li><a class="soc3" href="#"></a></li>
	</ul>
	<!--/start-copyright-->
	<div class="copy">
		<div class="container">
			<p>
				Copyright &copy; 2015.Company name All rights reserved.<a
					target="_blank" href="http://sc.chinaz.com/moban/">&#x7F51;&#x9875;&#x6A21;&#x677F;</a>
			</p>
		</div>
	</div>
	<!--//end-copyright-->
	<!--end-footer-->
	<!--//end-content-->
	<!--start-smooth-scrolling-->
	<script type="text/javascript">
									$(document).ready(function() {
										/*
										var defaults = {
								  			containerID: 'toTop', // fading element id
											containerHoverID: 'toTopHover', // fading element hover id
											scrollSpeed: 1200,
											easingType: 'linear' 
								 		};
										*/
										
										$().UItoTop({ easingType: 'easeOutQuart' });
										
									});
								</script>
	<a href="#home" id="toTop" class="scroll" style="display: block;">
		<span id="toTopHover" style="opacity: 1;"> </span>
	</a>


</body>
</html>